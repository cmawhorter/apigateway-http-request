{"version":3,"file":"apigateway-http-request.js","sources":["../node_modules/uuid/lib/rng.js","../node_modules/uuid/lib/bytesToUuid.js","../node_modules/uuid/v1.js","../node_modules/uuid/v4.js","../node_modules/uuid/index.js","../node_modules/safe-buffer/index.js","../node_modules/base-x/index.js","../node_modules/eyed/index.js","../node_modules/http-header-collection/dist/http-header-collection.es2015.js","../src/lib/http-headers.js","../src/lib/http-message.js","../src/requests/apigateway-http-request.js","../src/lib/status-codes.js","../src/responses/_base.js","../src/responses/error.js","../src/responses/success.js","../src/factory.js"],"sourcesContent":["// Unique ID creation requires a high quality random # generator.  In node.js\n// this is prett straight-forward - we use the crypto API.\n\nvar rb = require('crypto').randomBytes;\n\nfunction rng() {\n  return rb(16);\n};\n\nmodule.exports = rng;\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  return  bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\nmodule.exports = bytesToUuid;\n","// Unique ID creation requires a high quality random # generator.  We feature\n// detect to determine the best RNG source, normalizing to a function that\n// returns 128-bits of randomness, since that's what's usually required\nvar rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\n// random #'s we need to init node and clockseq\nvar _seedBytes = rng();\n\n// Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\nvar _nodeId = [\n  _seedBytes[0] | 0x01,\n  _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n];\n\n// Per 4.2.2, randomize (14 bit) clockseq\nvar _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n// Previous uuid creation time\nvar _lastMSecs = 0, _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  var node = options.node || _nodeId;\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options == 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n","/* eslint-disable node/no-deprecated-api */\nvar buffer = require('buffer')\nvar Buffer = buffer.Buffer\n\nif (Buffer.from && Buffer.alloc && Buffer.allocUnsafe && Buffer.allocUnsafeSlow) {\n  module.exports = buffer\n} else {\n  // Copy properties from require('buffer')\n  Object.keys(buffer).forEach(function (prop) {\n    exports[prop] = buffer[prop]\n  })\n  exports.Buffer = SafeBuffer\n}\n\nfunction SafeBuffer (arg, encodingOrOffset, length) {\n  return Buffer(arg, encodingOrOffset, length)\n}\n\n// Copy static methods from Buffer\nObject.keys(Buffer).forEach(function (prop) {\n  SafeBuffer[prop] = Buffer[prop]\n})\n\nSafeBuffer.from = function (arg, encodingOrOffset, length) {\n  if (typeof arg === 'number') {\n    throw new TypeError('Argument must not be a number')\n  }\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.alloc = function (size, fill, encoding) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  var buf = Buffer(size)\n  if (fill !== undefined) {\n    if (typeof encoding === 'string') {\n      buf.fill(fill, encoding)\n    } else {\n      buf.fill(fill)\n    }\n  } else {\n    buf.fill(0)\n  }\n  return buf\n}\n\nSafeBuffer.allocUnsafe = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return Buffer(size)\n}\n\nSafeBuffer.allocUnsafeSlow = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return buffer.SlowBuffer(size)\n}\n","// base-x encoding\n// Forked from https://github.com/cryptocoinjs/bs58\n// Originally written by Mike Hearn for BitcoinJ\n// Copyright (c) 2011 Google Inc\n// Ported to JavaScript by Stefan Thomas\n// Merged Buffer refactorings from base58-native by Stephen Pair\n// Copyright (c) 2013 BitPay Inc\n\nvar Buffer = require('safe-buffer').Buffer\n\nmodule.exports = function base (ALPHABET) {\n  var ALPHABET_MAP = {}\n  var BASE = ALPHABET.length\n  var LEADER = ALPHABET.charAt(0)\n\n  // pre-compute lookup table\n  for (var z = 0; z < ALPHABET.length; z++) {\n    var x = ALPHABET.charAt(z)\n\n    if (ALPHABET_MAP[x] !== undefined) throw new TypeError(x + ' is ambiguous')\n    ALPHABET_MAP[x] = z\n  }\n\n  function encode (source) {\n    if (source.length === 0) return ''\n\n    var digits = [0]\n    for (var i = 0; i < source.length; ++i) {\n      for (var j = 0, carry = source[i]; j < digits.length; ++j) {\n        carry += digits[j] << 8\n        digits[j] = carry % BASE\n        carry = (carry / BASE) | 0\n      }\n\n      while (carry > 0) {\n        digits.push(carry % BASE)\n        carry = (carry / BASE) | 0\n      }\n    }\n\n    var string = ''\n\n    // deal with leading zeros\n    for (var k = 0; source[k] === 0 && k < source.length - 1; ++k) string += ALPHABET[0]\n    // convert digits to a string\n    for (var q = digits.length - 1; q >= 0; --q) string += ALPHABET[digits[q]]\n\n    return string\n  }\n\n  function decodeUnsafe (string) {\n    if (string.length === 0) return Buffer.allocUnsafe(0)\n\n    var bytes = [0]\n    for (var i = 0; i < string.length; i++) {\n      var value = ALPHABET_MAP[string[i]]\n      if (value === undefined) return\n\n      for (var j = 0, carry = value; j < bytes.length; ++j) {\n        carry += bytes[j] * BASE\n        bytes[j] = carry & 0xff\n        carry >>= 8\n      }\n\n      while (carry > 0) {\n        bytes.push(carry & 0xff)\n        carry >>= 8\n      }\n    }\n\n    // deal with leading zeros\n    for (var k = 0; string[k] === LEADER && k < string.length - 1; ++k) {\n      bytes.push(0)\n    }\n\n    return Buffer.from(bytes.reverse())\n  }\n\n  function decode (string) {\n    var buffer = decodeUnsafe(string)\n    if (buffer) return buffer\n\n    throw new Error('Non-base' + BASE + ' character')\n  }\n\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\n","'use strict';\n\nvar uuid  = require('uuid');\nvar BaseX = require('base-x');\nvar basex = BaseX('0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ');\n\nvar ids = module.exports = {\n  separator: '_',\n\n  uuid: function() {\n    var buffer = new Buffer(16);\n    uuid.v4(null, buffer);\n    return basex.encode(buffer);\n  },\n\n  id: function(prefix, separator) {\n    separator = void 0 === separator ? ids.separator : separator || '';\n    return prefix + separator + ids.uuid();\n  },\n\n  create: function(prefix, separator) {\n    return ids.id.bind(null, prefix, separator);\n  }\n}\n","var toHeaderName = function (str) {\n  return (str || '').toString().trim();\n};\n\nvar toHeaderId = function (str) {\n  return toHeaderName(str).toLowerCase();\n};\n\nvar slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nvar find = function (collection, str) {\n  var searchHeaderId = toHeaderId(str);\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = collection[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var _step$value = slicedToArray(_step.value, 3),\n          headerId = _step$value[0],\n          headerName = _step$value[1],\n          headerValues = _step$value[2];\n\n      if (headerId === searchHeaderId) {\n        return headerValues;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return null;\n};\n\nvar append = function (collection, str, value) {\n  var existingHeader = find(collection, str);\n  if (!existingHeader) {\n    existingHeader = [];\n    collection.push([toHeaderId(str), toHeaderName(str), existingHeader]);\n  }\n  // only string is allowed\n  existingHeader.push('' + value);\n};\n\nvar remove = function (collection, str) {\n  var existingHeader = find(collection, str);\n  if (existingHeader) {\n    existingHeader.length = 0;\n  }\n};\n\nvar replace = function (collection, str, values) {\n  remove(collection, str);\n  values.forEach(function (value) {\n    return append(collection, str, value);\n  });\n};\n\nvar collapse = function (collection) {\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = collection[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var _step$value = slicedToArray(_step.value, 3),\n          headerId = _step$value[0],\n          headerName = _step$value[1],\n          headerValues = _step$value[2];\n\n      if (headerValues.length) {\n        var value = headerValues[headerValues.length - 1];\n        replace(collection, headerName, [value]);\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n};\n\nvar fromHash = function (obj, isFlat) {\n  if (void 0 === isFlat) isFlat = true; // default to expecting flat\n  obj = obj || {};\n  var collection = [];\n  Object.keys(obj).forEach(function (key) {\n    var value = obj[key];\n    if (isFlat) {\n      append(collection, key, value);\n    } else {\n      if (!Array.isArray(value)) {\n        value = [value];\n      }\n      value.forEach(function (item) {\n        return append(collection, key, item);\n      });\n    }\n  });\n  return collection;\n};\n\nvar has = function (collection, str, strict) {\n  var searchHeaderId = toHeaderId(str);\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = collection[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var _step$value = slicedToArray(_step.value, 3),\n          headerId = _step$value[0],\n          headerName = _step$value[1],\n          headerValues = _step$value[2];\n\n      if (headerId === searchHeaderId) {\n        return true === strict ? headerValues.length > 0 : true;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return false;\n};\n\nvar toHash = function (collection, flatten, strict) {\n  if (void 0 === flatten) flatten = true;\n  if (void 0 === strict) strict = true;\n  var obj = {};\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = collection[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var _step$value = slicedToArray(_step.value, 3),\n          headerId = _step$value[0],\n          headerName = _step$value[1],\n          headerValues = _step$value[2];\n\n      var isEmpty = headerValues.length === 0;\n      if (!isEmpty || true !== strict) {\n        var value = void 0;\n        if (isEmpty) {\n          value = flatten ? null : [];\n        } else {\n          value = flatten ? headerValues[headerValues.length - 1] : Array.prototype.slice.call(headerValues);\n        }\n        obj[headerName] = value;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return obj;\n};\n\nexport { append, collapse, find, fromHash, has, remove, replace, toHash, toHeaderId, toHeaderName };\n//# sourceMappingURL=http-header-collection.es2015.js.map\n","import { remove, replace, toHash, fromHash, find } from 'http-header-collection';\n\nexport default class HttpHeaders {\n  constructor(arrOrHash) {\n    this._collection = [];\n    this.import(arrOrHash);\n  }\n\n  import(arrOrHash) {\n    if (Array.isArray(arrOrHash)) {\n      this._collection = arrOrHash;\n    }\n    else if (null !== arrOrHash && undefined !== arrOrHash) {\n      this._collection = fromHash(arrOrHash, true);\n    }\n  }\n\n  get(headerName) {\n    let headerValues = find(this._collection, headerName);\n    return null === headerValues ? undefined : headerValues[0];\n  }\n\n  add(headerName, headerValue) {\n    // apigateway doesn't support dupe header names (multiple values)\n    replace(this._collection, headerName, [headerValue]);\n  }\n\n  remove(headerName) {\n    remove(this._collection, headerName);\n  }\n\n  toRawHeaders() {\n    let rawHeaders = [];\n    for (let [headerId, headerName, headerValues] of this._collection) {\n      let headerValue = headerValues[0];\n      if (headerValue && null !== headerValue) {\n        rawHeaders.push(`${headerName}: ${headerValue}`);\n      }\n    }\n    return rawHeaders;\n  }\n\n  toJSON() {\n    let flattenHeaderValues       = true;\n    let strictHeaderValueRequired = true;\n    return toHash(this._collection, flattenHeaderValues, strictHeaderValueRequired);\n  }\n\n  toString() {\n    return this.toRawHeaders().join('\\n');\n  }\n\n  // array methods\n\n  _nativeArrayMethod(method, args) {\n    return this._collection[method].apply(this._collection, args);\n  }\n\n  get length() {\n    return this._collection.length;\n  }\n\n  forEach()   { return this._nativeArrayMethod('forEach', arguments); }\n  every()     { return this._nativeArrayMethod('every', arguments); }\n  filter()    { return this._nativeArrayMethod('filter', arguments); }\n  find()      { return this._nativeArrayMethod('find', arguments); }\n  includes()  { return this._nativeArrayMethod('includes', arguments); }\n  map()       { return this._nativeArrayMethod('map', arguments); }\n  some()      { return this._nativeArrayMethod('some', arguments); }\n}\n","import { id as generateId } from 'eyed';\nimport HttpHeaders from './http-headers.js';\n\nexport default class HttpMessage {\n  constructor(headers, body, requestId) {\n    this._requestId   = requestId || generateId('req');\n    this._headers     = new HttpHeaders(headers);\n    this._body        = body;\n  }\n\n  get requestId() {\n    return this._requestId;\n  }\n\n  get headers() {\n    return this._headers;\n  }\n\n  get body() {\n    return this._body;\n  }\n\n  set body(value) {\n    this._body = value;\n  }\n}\n","import HttpMessage from '../lib/http-message.js';\n\nexport default class ApigatewayHttpRequest extends HttpMessage {\n  constructor(data) {\n    data = data || {};\n    super(data.headers, data.body, data.requestId);\n    this.resource     = data.resource || null;\n    this.method       = data.method || null;\n    this.path         = data.path || [];\n    this.querystring  = data.querystring || {};\n    this.context      = data.context || {};\n  }\n\n  get query() {\n    return this.querystring;\n  }\n\n  toJSON() {\n    return {\n      headers:      this.headers.toJSON(),\n      body:         this.body,\n      requestId:    this.requestId,\n      resource:     this.resource,\n      method:       this.method,\n      path:         this.path,\n      querystring:  this.querystring,\n      context:      this.context,\n    };\n  }\n}\n","export function assertValidStatusCode(value) {\n  if (isNaN(value)) throw new Error('statusCode must be number');\n  if (value < 0) throw new Error('statusCode must be positive number');\n  if (Math.floor(value) !== value) throw new Error('statusCode must be whole number');\n}\n","import HttpMessage from '../lib/http-message.js';\nimport { assertValidStatusCode } from '../lib/status-codes.js';\n\nexport default class BaseResponse extends HttpMessage {\n  constructor(body, statusCode, headers, requestId) {\n    super(headers, body, requestId);\n    this._statusCode = statusCode || 0;\n  }\n\n  get statusCode() {\n    return this._statusCode;\n  }\n\n  set statusCode(value) {\n    assertValidStatusCode(value);\n    this._statusCode = value;\n  }\n\n  addCORS(scope) {\n    this.headers.add('access-control-allow-origin', scope);\n  }\n\n  addGlobalCORS() {\n    this.addCORS('*');\n  }\n\n  toResponse() {\n    return this.body;\n  }\n\n  format() {\n    let statusCode  = this.statusCode;\n    let body        = this.toResponse();\n    let encBody     = null;\n    if (Buffer.isBuffer(body)) {\n      encBody = body.toString('base64');\n      this.headers.add('content-type', 'application/octet-stream');\n    }\n    else if (undefined !== body) {\n      encBody = JSON.stringify(body);\n      this.headers.add('content-type', 'application/json');\n    }\n    else {\n      // noop.  no body\n    }\n    return {\n      statusCode,\n      headers:      this.headers.toJSON(),\n      body:         encBody\n    };\n  }\n}\n","import BaseResponse from './_base.js';\n\nexport default class ErrorResponse extends BaseResponse {\n  constructor(message, type, statusCode, headers, requestId) {\n    super(undefined, statusCode, headers, requestId);\n    this.type       = type || ErrorResponse.UNKNOWN;\n    this.message    = message || null;\n    this.code       = null;\n    this.request    = null;\n  }\n\n  toResponse() {\n    return {\n      error: {\n        type:     this.type,\n        message:  this.message,\n        code:     this.code,\n        request:  this.request,\n      },\n    };\n  }\n}\n\nErrorResponse.UNKNOWN          = 'unknown_error';\nErrorResponse.NETWORK          = 'network_error';\nErrorResponse.API              = 'api_error';\nErrorResponse.AUTH             = 'authentication_error';\nErrorResponse.INVALID_REQUEST  = 'invalid_request_error';\n","import BaseResponse from './_base.js';\n\nexport default class SuccessResponse extends BaseResponse {\n  constructor(body, statusCode, headers, requestId) {\n    super(body, statusCode, headers, requestId);\n  }\n\n  toResponse() {\n    return this.body;\n  }\n}\n","import ApigatewayHttpRequest from './requests/apigateway-http-request.js';\n\nexport function fromIncomingEvent(event, requestId) {\n  let requestContext  = event.requestContext;\n  let headers         = event.headers || {};\n  let body            = event.body || null;\n  let path            = ((event.pathParameters || {}).proxy || '').split('/');\n  let request = new ApigatewayHttpRequest({\n    headers,\n    requestId:    requestId || requestContext.requestId,\n    method:       event.httpMethod || null,\n    path:         path,\n    resource:     path.shift(),\n    querystring:  event.queryStringParameters,\n    context:      requestContext,\n  });\n  if (event.isBase64Encoded) {\n    request.body = new Buffer(body, 'base64').toString();\n  }\n  else if (typeof body === 'string') {\n    request.body = JSON.parse(body);\n  }\n  return request;\n}\n\n\n"],"names":["require$$0","rng","bytesToUuid","require$$1","v1","v4","buffer","Buffer","HttpHeaders","arrOrHash","_collection","import","Array","isArray","undefined","fromHash","headerName","headerValues","find","headerValue","rawHeaders","headerId","push","flattenHeaderValues","strictHeaderValueRequired","toHash","toRawHeaders","join","method","args","apply","_nativeArrayMethod","arguments","length","HttpMessage","headers","body","requestId","_requestId","generateId","_headers","_body","value","ApigatewayHttpRequest","data","resource","path","querystring","context","toJSON","assertValidStatusCode","isNaN","Error","Math","floor","BaseResponse","statusCode","_statusCode","scope","add","addCORS","toResponse","encBody","isBuffer","toString","JSON","stringify","ErrorResponse","message","type","UNKNOWN","code","request","NETWORK","API","AUTH","INVALID_REQUEST","SuccessResponse","fromIncomingEvent","event","requestContext","pathParameters","proxy","split","httpMethod","shift","queryStringParameters","isBase64Encoded","parse"],"mappings":";;;;;;;;;;AAAA;;;AAGA,IAAI,EAAE,GAAGA,MAAiB,CAAC,WAAW,CAAC;;AAEvC,SAASC,KAAG,GAAG;EACb,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;CACf,AAAC;;AAEF,SAAc,GAAGA,KAAG,CAAC;;ACTrB;;;;AAIA,IAAI,SAAS,GAAG,EAAE,CAAC;AACnB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,EAAE,CAAC,EAAE;EAC5B,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK,EAAE,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;CACnD;;AAED,SAASC,aAAW,CAAC,GAAG,EAAE,MAAM,EAAE;EAChC,IAAI,CAAC,GAAG,MAAM,IAAI,CAAC,CAAC;EACpB,IAAI,GAAG,GAAG,SAAS,CAAC;EACpB,QAAQ,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;UAC7B,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG;UACnC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG;UACnC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG;UACnC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG;UACnC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;UAC7B,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;UAC7B,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;CACvC;;AAED,iBAAc,GAAGA,aAAW,CAAC;;ACtB7B;;;AAGA,IAAI,GAAG,GAAGF,KAAoB,CAAC;AAC/B,IAAI,WAAW,GAAGG,aAA4B,CAAC;;;;;;;;AAQ/C,IAAI,UAAU,GAAG,GAAG,EAAE,CAAC;;;AAGvB,IAAI,OAAO,GAAG;EACZ,UAAU,CAAC,CAAC,CAAC,GAAG,IAAI;EACpB,UAAU,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC;CAC1E,CAAC;;;AAGF,IAAI,SAAS,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,IAAI,MAAM,CAAC;;;AAG9D,IAAI,UAAU,GAAG,CAAC;IAAE,UAAU,GAAG,CAAC,CAAC;;;AAGnC,SAASC,IAAE,CAAC,OAAO,EAAE,GAAG,EAAE,MAAM,EAAE;EAChC,IAAI,CAAC,GAAG,GAAG,IAAI,MAAM,IAAI,CAAC,CAAC;EAC3B,IAAI,CAAC,GAAG,GAAG,IAAI,EAAE,CAAC;;EAElB,OAAO,GAAG,OAAO,IAAI,EAAE,CAAC;;EAExB,IAAI,QAAQ,GAAG,OAAO,CAAC,QAAQ,KAAK,SAAS,GAAG,OAAO,CAAC,QAAQ,GAAG,SAAS,CAAC;;;;;;EAM7E,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,KAAK,SAAS,GAAG,OAAO,CAAC,KAAK,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;;;;EAI/E,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,KAAK,SAAS,GAAG,OAAO,CAAC,KAAK,GAAG,UAAU,GAAG,CAAC,CAAC;;;EAGzE,IAAI,EAAE,GAAG,CAAC,KAAK,GAAG,UAAU,IAAI,CAAC,KAAK,GAAG,UAAU,EAAE,KAAK,CAAC;;;EAG3D,IAAI,EAAE,GAAG,CAAC,IAAI,OAAO,CAAC,QAAQ,KAAK,SAAS,EAAE;IAC5C,QAAQ,GAAG,QAAQ,GAAG,CAAC,GAAG,MAAM,CAAC;GAClC;;;;EAID,IAAI,CAAC,EAAE,GAAG,CAAC,IAAI,KAAK,GAAG,UAAU,KAAK,OAAO,CAAC,KAAK,KAAK,SAAS,EAAE;IACjE,KAAK,GAAG,CAAC,CAAC;GACX;;;EAGD,IAAI,KAAK,IAAI,KAAK,EAAE;IAClB,MAAM,IAAI,KAAK,CAAC,kDAAkD,CAAC,CAAC;GACrE;;EAED,UAAU,GAAG,KAAK,CAAC;EACnB,UAAU,GAAG,KAAK,CAAC;EACnB,SAAS,GAAG,QAAQ,CAAC;;;EAGrB,KAAK,IAAI,cAAc,CAAC;;;EAGxB,IAAI,EAAE,GAAG,CAAC,CAAC,KAAK,GAAG,SAAS,IAAI,KAAK,GAAG,KAAK,IAAI,WAAW,CAAC;EAC7D,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC;EAC1B,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC;EAC1B,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,CAAC,GAAG,IAAI,CAAC;EACzB,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC;;;EAGnB,IAAI,GAAG,GAAG,CAAC,KAAK,GAAG,WAAW,GAAG,KAAK,IAAI,SAAS,CAAC;EACpD,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,IAAI,CAAC;EAC1B,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC;;;EAGpB,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,KAAK,EAAE,GAAG,GAAG,GAAG,IAAI,CAAC;EACjC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,KAAK,EAAE,GAAG,IAAI,CAAC;;;EAG3B,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,QAAQ,KAAK,CAAC,GAAG,IAAI,CAAC;;;EAG/B,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,QAAQ,GAAG,IAAI,CAAC;;;EAGzB,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC;EACnC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;IAC1B,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;GACpB;;EAED,OAAO,GAAG,GAAG,GAAG,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;CACnC;;AAED,QAAc,GAAGA,IAAE,CAAC;;ACtGpB,IAAIH,KAAG,GAAGD,KAAoB,CAAC;AAC/B,IAAIE,aAAW,GAAGC,aAA4B,CAAC;;AAE/C,SAASE,IAAE,CAAC,OAAO,EAAE,GAAG,EAAE,MAAM,EAAE;EAChC,IAAI,CAAC,GAAG,GAAG,IAAI,MAAM,IAAI,CAAC,CAAC;;EAE3B,IAAI,OAAO,OAAO,CAAC,IAAI,QAAQ,EAAE;IAC/B,GAAG,GAAG,OAAO,IAAI,QAAQ,GAAG,IAAI,KAAK,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;IACjD,OAAO,GAAG,IAAI,CAAC;GAChB;EACD,OAAO,GAAG,OAAO,IAAI,EAAE,CAAC;;EAExB,IAAI,IAAI,GAAG,OAAO,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,GAAG,IAAIJ,KAAG,GAAG,CAAC;;;EAGpD,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,IAAI,IAAI,CAAC;EAClC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,IAAI,IAAI,CAAC;;;EAGlC,IAAI,GAAG,EAAE;IACP,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE;MAC9B,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;KACxB;GACF;;EAED,OAAO,GAAG,IAAIC,aAAW,CAAC,IAAI,CAAC,CAAC;CACjC;;AAED,QAAc,GAAGG,IAAE,CAAC;;AC5BpB,IAAI,EAAE,GAAGL,IAAe,CAAC;AACzB,IAAI,EAAE,GAAGG,IAAe,CAAC;;AAEzB,IAAI,IAAI,GAAG,EAAE,CAAC;AACd,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;AACb,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;;AAEb,WAAc,GAAG,IAAI,CAAC;;;;ACNtB,IAAIG,SAAM,GAAGN,MAAiB,CAAA;AAC9B,IAAI,MAAM,GAAGM,SAAM,CAAC,MAAM,CAAA;;AAE1B,IAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,WAAW,IAAI,MAAM,CAAC,eAAe,EAAE;EAC/E,cAAc,GAAGA,SAAM,CAAA;CACxB,MAAM;;EAEL,MAAM,CAAC,IAAI,CAACA,SAAM,CAAC,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE;IAC1C,OAAO,CAAC,IAAI,CAAC,GAAGA,SAAM,CAAC,IAAI,CAAC,CAAA;GAC7B,CAAC,CAAA;EACF,cAAc,GAAG,UAAU,CAAA;CAC5B;;AAED,SAAS,UAAU,EAAE,GAAG,EAAE,gBAAgB,EAAE,MAAM,EAAE;EAClD,OAAO,MAAM,CAAC,GAAG,EAAE,gBAAgB,EAAE,MAAM,CAAC;CAC7C;;;AAGD,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE;EAC1C,UAAU,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,CAAA;CAChC,CAAC,CAAA;;AAEF,UAAU,CAAC,IAAI,GAAG,UAAU,GAAG,EAAE,gBAAgB,EAAE,MAAM,EAAE;EACzD,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;IAC3B,MAAM,IAAI,SAAS,CAAC,+BAA+B,CAAC;GACrD;EACD,OAAO,MAAM,CAAC,GAAG,EAAE,gBAAgB,EAAE,MAAM,CAAC;CAC7C,CAAA;;AAED,UAAU,CAAC,KAAK,GAAG,UAAU,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE;EACjD,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;IAC5B,MAAM,IAAI,SAAS,CAAC,2BAA2B,CAAC;GACjD;EACD,IAAI,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,CAAA;EACtB,IAAI,IAAI,KAAK,SAAS,EAAE;IACtB,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;MAChC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAA;KACzB,MAAM;MACL,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;KACf;GACF,MAAM;IACL,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;GACZ;EACD,OAAO,GAAG;CACX,CAAA;;AAED,UAAU,CAAC,WAAW,GAAG,UAAU,IAAI,EAAE;EACvC,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;IAC5B,MAAM,IAAI,SAAS,CAAC,2BAA2B,CAAC;GACjD;EACD,OAAO,MAAM,CAAC,IAAI,CAAC;CACpB,CAAA;;AAED,UAAU,CAAC,eAAe,GAAG,UAAU,IAAI,EAAE;EAC3C,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;IAC5B,MAAM,IAAI,SAAS,CAAC,2BAA2B,CAAC;GACjD;EACD,OAAOA,SAAM,CAAC,UAAU,CAAC,IAAI,CAAC;CAC/B,CAAA;;;AC3DD;;;;;;;;AAQA,IAAIC,QAAM,GAAGP,OAAsB,CAAC,MAAM,CAAA;;AAE1C,WAAc,GAAG,SAAS,IAAI,EAAE,QAAQ,EAAE;EACxC,IAAI,YAAY,GAAG,EAAE,CAAA;EACrB,IAAI,IAAI,GAAG,QAAQ,CAAC,MAAM,CAAA;EAC1B,IAAI,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAA;;;EAG/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;IACxC,IAAI,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAA;;IAE1B,IAAI,YAAY,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE,MAAM,IAAI,SAAS,CAAC,CAAC,GAAG,eAAe,CAAC;IAC3E,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,CAAA;GACpB;;EAED,SAAS,MAAM,EAAE,MAAM,EAAE;IACvB,IAAI,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE,OAAO,EAAE;;IAElC,IAAI,MAAM,GAAG,CAAC,CAAC,CAAC,CAAA;IAChB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;MACtC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;QACzD,KAAK,IAAI,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;QACvB,MAAM,CAAC,CAAC,CAAC,GAAG,KAAK,GAAG,IAAI,CAAA;QACxB,KAAK,GAAG,CAAC,KAAK,GAAG,IAAI,IAAI,CAAC,CAAA;OAC3B;;MAED,OAAO,KAAK,GAAG,CAAC,EAAE;QAChB,MAAM,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,CAAA;QACzB,KAAK,GAAG,CAAC,KAAK,GAAG,IAAI,IAAI,CAAC,CAAA;OAC3B;KACF;;IAED,IAAI,MAAM,GAAG,EAAE,CAAA;;;IAGf,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE,MAAM,IAAI,QAAQ,CAAC,CAAC,CAAC,CAAA;;IAEpF,KAAK,IAAI,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE,MAAM,IAAI,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAA;;IAE1E,OAAO,MAAM;GACd;;EAED,SAAS,YAAY,EAAE,MAAM,EAAE;IAC7B,IAAI,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE,OAAOO,QAAM,CAAC,WAAW,CAAC,CAAC,CAAC;;IAErD,IAAI,KAAK,GAAG,CAAC,CAAC,CAAC,CAAA;IACf,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;MACtC,IAAI,KAAK,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAA;MACnC,IAAI,KAAK,KAAK,SAAS,EAAE,MAAM;;MAE/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,GAAG,KAAK,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;QACpD,KAAK,IAAI,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAA;QACxB,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,GAAG,IAAI,CAAA;QACvB,KAAK,KAAK,CAAC,CAAA;OACZ;;MAED,OAAO,KAAK,GAAG,CAAC,EAAE;QAChB,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,CAAA;QACxB,KAAK,KAAK,CAAC,CAAA;OACZ;KACF;;;IAGD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,KAAK,MAAM,IAAI,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;MAClE,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;KACd;;IAED,OAAOA,QAAM,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;GACpC;;EAED,SAAS,MAAM,EAAE,MAAM,EAAE;IACvB,IAAID,SAAM,GAAG,YAAY,CAAC,MAAM,CAAC,CAAA;IACjC,IAAIA,SAAM,EAAE,OAAOA,SAAM;;IAEzB,MAAM,IAAI,KAAK,CAAC,UAAU,GAAG,IAAI,GAAG,YAAY,CAAC;GAClD;;EAED,OAAO;IACL,MAAM,EAAE,MAAM;IACd,YAAY,EAAE,YAAY;IAC1B,MAAM,EAAE,MAAM;GACf;CACF,CAAA;;;AC1FD,YAAY,CAAC;;AAEb,IAAI,IAAI,IAAIN,OAAe,CAAC;AAC5B,IAAI,KAAK,GAAGG,OAAiB,CAAC;AAC9B,IAAI,KAAK,GAAG,KAAK,CAAC,gEAAgE,CAAC,CAAC;;AAEpF,IAAI,GAAG,GAAG,cAAc,GAAG;EACzB,SAAS,EAAE,GAAG;;EAEd,IAAI,EAAE,WAAW;IACf,IAAIG,SAAM,GAAG,IAAI,MAAM,CAAC,EAAE,CAAC,CAAC;IAC5B,IAAI,CAAC,EAAE,CAAC,IAAI,EAAEA,SAAM,CAAC,CAAC;IACtB,OAAO,KAAK,CAAC,MAAM,CAACA,SAAM,CAAC,CAAC;GAC7B;;EAED,EAAE,EAAE,SAAS,MAAM,EAAE,SAAS,EAAE;IAC9B,SAAS,GAAG,KAAK,CAAC,KAAK,SAAS,GAAG,GAAG,CAAC,SAAS,GAAG,SAAS,IAAI,EAAE,CAAC;IACnE,OAAO,MAAM,GAAG,SAAS,GAAG,GAAG,CAAC,IAAI,EAAE,CAAC;GACxC;;EAED,MAAM,EAAE,SAAS,MAAM,EAAE,SAAS,EAAE;IAClC,OAAO,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,SAAS,CAAC,CAAC;GAC7C;CACF,CAAA;;;;;ACvBD,IAAI,YAAY,GAAG,UAAU,GAAG,EAAE;EAChC,OAAO,CAAC,GAAG,IAAI,EAAE,EAAE,QAAQ,EAAE,CAAC,IAAI,EAAE,CAAC;CACtC,CAAC;;AAEF,IAAI,UAAU,GAAG,UAAU,GAAG,EAAE;EAC9B,OAAO,YAAY,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC;CACxC,CAAC;;AAEF,IAAI,aAAa,GAAG,YAAY;EAC9B,SAAS,aAAa,CAAC,GAAG,EAAE,CAAC,EAAE;IAC7B,IAAI,IAAI,GAAG,EAAE,CAAC;IACd,IAAI,EAAE,GAAG,IAAI,CAAC;IACd,IAAI,EAAE,GAAG,KAAK,CAAC;IACf,IAAI,EAAE,GAAG,SAAS,CAAC;;IAEnB,IAAI;MACF,KAAK,IAAI,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,GAAG,EAAE,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,GAAG,IAAI,EAAE;QAClF,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;;QAEpB,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE,MAAM;OACnC;KACF,CAAC,OAAO,GAAG,EAAE;MACZ,EAAE,GAAG,IAAI,CAAC;MACV,EAAE,GAAG,GAAG,CAAC;KACV,SAAS;MACR,IAAI;QACF,IAAI,CAAC,EAAE,IAAI,EAAE,CAAC,QAAQ,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC;OACzC,SAAS;QACR,IAAI,EAAE,EAAE,MAAM,EAAE,CAAC;OAClB;KACF;;IAED,OAAO,IAAI,CAAC;GACb;;EAED,OAAO,UAAU,GAAG,EAAE,CAAC,EAAE;IACvB,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;MACtB,OAAO,GAAG,CAAC;KACZ,MAAM,IAAI,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC,GAAG,CAAC,EAAE;MACzC,OAAO,aAAa,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;KAC9B,MAAM;MACL,MAAM,IAAI,SAAS,CAAC,sDAAsD,CAAC,CAAC;KAC7E;GACF,CAAC;CACH,EAAE,CAAC;;AAEJ,IAAI,IAAI,GAAG,UAAU,UAAU,EAAE,GAAG,EAAE;EACpC,IAAI,cAAc,GAAG,UAAU,CAAC,GAAG,CAAC,CAAC;EACrC,IAAI,yBAAyB,GAAG,IAAI,CAAC;EACrC,IAAI,iBAAiB,GAAG,KAAK,CAAC;EAC9B,IAAI,cAAc,GAAG,SAAS,CAAC;;EAE/B,IAAI;IACF,KAAK,IAAI,SAAS,GAAG,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,EAAE,KAAK,EAAE,EAAE,yBAAyB,GAAG,CAAC,KAAK,GAAG,SAAS,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,EAAE,yBAAyB,GAAG,IAAI,EAAE;MAC3J,IAAI,WAAW,GAAG,aAAa,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;UAC3C,QAAQ,GAAG,WAAW,CAAC,CAAC,CAAC;UACzB,UAAU,GAAG,WAAW,CAAC,CAAC,CAAC;UAC3B,YAAY,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;;MAElC,IAAI,QAAQ,KAAK,cAAc,EAAE;QAC/B,OAAO,YAAY,CAAC;OACrB;KACF;GACF,CAAC,OAAO,GAAG,EAAE;IACZ,iBAAiB,GAAG,IAAI,CAAC;IACzB,cAAc,GAAG,GAAG,CAAC;GACtB,SAAS;IACR,IAAI;MACF,IAAI,CAAC,yBAAyB,IAAI,SAAS,CAAC,MAAM,EAAE;QAClD,SAAS,CAAC,MAAM,EAAE,CAAC;OACpB;KACF,SAAS;MACR,IAAI,iBAAiB,EAAE;QACrB,MAAM,cAAc,CAAC;OACtB;KACF;GACF;;EAED,OAAO,IAAI,CAAC;CACb,CAAC;;AAEF,IAAI,MAAM,GAAG,UAAU,UAAU,EAAE,GAAG,EAAE,KAAK,EAAE;EAC7C,IAAI,cAAc,GAAG,IAAI,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC;EAC3C,IAAI,CAAC,cAAc,EAAE;IACnB,cAAc,GAAG,EAAE,CAAC;IACpB,UAAU,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,YAAY,CAAC,GAAG,CAAC,EAAE,cAAc,CAAC,CAAC,CAAC;GACvE;;EAED,cAAc,CAAC,IAAI,CAAC,EAAE,GAAG,KAAK,CAAC,CAAC;CACjC,CAAC;;AAEF,IAAI,MAAM,GAAG,UAAU,UAAU,EAAE,GAAG,EAAE;EACtC,IAAI,cAAc,GAAG,IAAI,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC;EAC3C,IAAI,cAAc,EAAE;IAClB,cAAc,CAAC,MAAM,GAAG,CAAC,CAAC;GAC3B;CACF,CAAC;;AAEF,IAAI,OAAO,GAAG,UAAU,UAAU,EAAE,GAAG,EAAE,MAAM,EAAE;EAC/C,MAAM,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC;EACxB,MAAM,CAAC,OAAO,CAAC,UAAU,KAAK,EAAE;IAC9B,OAAO,MAAM,CAAC,UAAU,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;GACvC,CAAC,CAAC;CACJ,CAAC;;AAEF,AACE,AACA,AACA,AAEA,AAyBC,AAGH,IAAI,QAAQ,GAAG,UAAU,GAAG,EAAE,MAAM,EAAE;EACpC,IAAI,KAAK,CAAC,KAAK,MAAM,EAAE,MAAM,GAAG,IAAI,CAAC;EACrC,GAAG,GAAG,GAAG,IAAI,EAAE,CAAC;EAChB,IAAI,UAAU,GAAG,EAAE,CAAC;EACpB,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,GAAG,EAAE;IACtC,IAAI,KAAK,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC;IACrB,IAAI,MAAM,EAAE;MACV,MAAM,CAAC,UAAU,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;KAChC,MAAM;MACL,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;QACzB,KAAK,GAAG,CAAC,KAAK,CAAC,CAAC;OACjB;MACD,KAAK,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE;QAC5B,OAAO,MAAM,CAAC,UAAU,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;OACtC,CAAC,CAAC;KACJ;GACF,CAAC,CAAC;EACH,OAAO,UAAU,CAAC;CACnB,CAAC;;AAEF,AACE,AACA,AACA,AACA,AAEA,AA0BA,AAGF,IAAI,MAAM,GAAG,UAAU,UAAU,EAAE,OAAO,EAAE,MAAM,EAAE;EAClD,IAAI,KAAK,CAAC,KAAK,OAAO,EAAE,OAAO,GAAG,IAAI,CAAC;EACvC,IAAI,KAAK,CAAC,KAAK,MAAM,EAAE,MAAM,GAAG,IAAI,CAAC;EACrC,IAAI,GAAG,GAAG,EAAE,CAAC;EACb,IAAI,yBAAyB,GAAG,IAAI,CAAC;EACrC,IAAI,iBAAiB,GAAG,KAAK,CAAC;EAC9B,IAAI,cAAc,GAAG,SAAS,CAAC;;EAE/B,IAAI;IACF,KAAK,IAAI,SAAS,GAAG,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,EAAE,KAAK,EAAE,EAAE,yBAAyB,GAAG,CAAC,KAAK,GAAG,SAAS,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,EAAE,yBAAyB,GAAG,IAAI,EAAE;MAC3J,IAAI,WAAW,GAAG,aAAa,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;UAC3C,QAAQ,GAAG,WAAW,CAAC,CAAC,CAAC;UACzB,UAAU,GAAG,WAAW,CAAC,CAAC,CAAC;UAC3B,YAAY,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;;MAElC,IAAI,OAAO,GAAG,YAAY,CAAC,MAAM,KAAK,CAAC,CAAC;MACxC,IAAI,CAAC,OAAO,IAAI,IAAI,KAAK,MAAM,EAAE;QAC/B,IAAI,KAAK,GAAG,KAAK,CAAC,CAAC;QACnB,IAAI,OAAO,EAAE;UACX,KAAK,GAAG,OAAO,GAAG,IAAI,GAAG,EAAE,CAAC;SAC7B,MAAM;UACL,KAAK,GAAG,OAAO,GAAG,YAAY,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;SACpG;QACD,GAAG,CAAC,UAAU,CAAC,GAAG,KAAK,CAAC;OACzB;KACF;GACF,CAAC,OAAO,GAAG,EAAE;IACZ,iBAAiB,GAAG,IAAI,CAAC;IACzB,cAAc,GAAG,GAAG,CAAC;GACtB,SAAS;IACR,IAAI;MACF,IAAI,CAAC,yBAAyB,IAAI,SAAS,CAAC,MAAM,EAAE;QAClD,SAAS,CAAC,MAAM,EAAE,CAAC;OACpB;KACF,SAAS;MACR,IAAI,iBAAiB,EAAE;QACrB,MAAM,cAAc,CAAC;OACtB;KACF;GACF;;EAED,OAAO,GAAG,CAAC;CACZ,CAAC,AAEF,AAAoG,AACpG,AAAyD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IC5OpCE;uBACPC,SAAZ,EAAuB;;;SAChBC,WAAL,GAAmB,EAAnB;SACKC,MAAL,CAAYF,SAAZ;;;;;4BAGKA,WAAW;UACZG,MAAMC,OAAN,CAAcJ,SAAd,CAAJ,EAA8B;aACvBC,WAAL,GAAmBD,SAAnB;OADF,MAGK,IAAI,SAASA,SAAT,IAAsBK,cAAcL,SAAxC,EAAmD;aACjDC,WAAL,GAAmBK,SAASN,SAAT,EAAoB,IAApB,CAAnB;;;;;2BAIAO,YAAY;UACVC,eAAeC,KAAK,KAAKR,WAAV,EAAuBM,UAAvB,CAAnB;aACO,SAASC,YAAT,GAAwBH,SAAxB,GAAoCG,aAAa,CAAb,CAA3C;;;;wBAGED,YAAYG,aAAa;;cAEnB,KAAKT,WAAb,EAA0BM,UAA1B,EAAsC,CAACG,WAAD,CAAtC;;;;8BAGKH,YAAY;aACV,KAAKN,WAAZ,EAAyBM,UAAzB;;;;mCAGa;UACTI,aAAa,EAAjB;;;;;;6BACiD,KAAKV,WAAtD,8HAAmE;;cAAzDW,QAAyD;cAA/CL,UAA+C;cAAnCC,YAAmC;;cAC7DE,cAAcF,aAAa,CAAb,CAAlB;cACIE,eAAe,SAASA,WAA5B,EAAyC;uBAC5BG,IAAX,CAAmBN,UAAnB,UAAkCG,WAAlC;;;;;;;;;;;;;;;;;;aAGGC,UAAP;;;;6BAGO;UACHG,sBAA4B,IAAhC;UACIC,4BAA4B,IAAhC;aACOC,OAAO,KAAKf,WAAZ,EAAyBa,mBAAzB,EAA8CC,yBAA9C,CAAP;;;;+BAGS;aACF,KAAKE,YAAL,GAAoBC,IAApB,CAAyB,IAAzB,CAAP;;;;;;;uCAKiBC,QAAQC,MAAM;aACxB,KAAKnB,WAAL,CAAiBkB,MAAjB,EAAyBE,KAAzB,CAA+B,KAAKpB,WAApC,EAAiDmB,IAAjD,CAAP;;;;8BAOU;aAAS,KAAKE,kBAAL,CAAwB,SAAxB,EAAmCC,SAAnC,CAAP;;;;4BACF;aAAS,KAAKD,kBAAL,CAAwB,OAAxB,EAAiCC,SAAjC,CAAP;;;;6BACF;aAAS,KAAKD,kBAAL,CAAwB,QAAxB,EAAkCC,SAAlC,CAAP;;;;8BACF;aAAS,KAAKD,kBAAL,CAAwB,MAAxB,EAAgCC,SAAhC,CAAP;;;;+BACF;aAAS,KAAKD,kBAAL,CAAwB,UAAxB,EAAoCC,SAApC,CAAP;;;;0BACF;aAAS,KAAKD,kBAAL,CAAwB,KAAxB,EAA+BC,SAA/B,CAAP;;;;2BACF;aAAS,KAAKD,kBAAL,CAAwB,MAAxB,EAAgCC,SAAhC,CAAP;;;;2BAVD;aACJ,KAAKtB,WAAL,CAAiBuB,MAAxB;;;;;;ICxDiBC;uBACPC,OAAZ,EAAqBC,IAArB,EAA2BC,SAA3B,EAAsC;;;SAC/BC,UAAL,GAAoBD,aAAaE,QAAW,KAAX,CAAjC;SACKC,QAAL,GAAoB,IAAIhC,WAAJ,CAAgB2B,OAAhB,CAApB;SACKM,KAAL,GAAoBL,IAApB;;;;;2BAGc;aACP,KAAKE,UAAZ;;;;2BAGY;aACL,KAAKE,QAAZ;;;;2BAGS;aACF,KAAKC,KAAZ;;yBAGOC,OAAO;WACTD,KAAL,GAAaC,KAAb;;;;;;ICrBiBC;;;iCACPC,IAAZ,EAAkB;;;WACTA,QAAQ,EAAf;;6IACMA,KAAKT,OAFK,EAEIS,KAAKR,IAFT,EAEeQ,KAAKP,SAFpB;;UAGXQ,QAAL,GAAoBD,KAAKC,QAAL,IAAiB,IAArC;UACKjB,MAAL,GAAoBgB,KAAKhB,MAAL,IAAe,IAAnC;UACKkB,IAAL,GAAoBF,KAAKE,IAAL,IAAa,EAAjC;UACKC,WAAL,GAAoBH,KAAKG,WAAL,IAAoB,EAAxC;UACKC,OAAL,GAAoBJ,KAAKI,OAAL,IAAgB,EAApC;;;;;;6BAOO;aACA;iBACS,KAAKb,OAAL,CAAac,MAAb,EADT;cAES,KAAKb,IAFd;mBAGS,KAAKC,SAHd;kBAIS,KAAKQ,QAJd;gBAKS,KAAKjB,MALd;cAMS,KAAKkB,IANd;qBAOS,KAAKC,WAPd;iBAQS,KAAKC;OARrB;;;;2BALU;aACH,KAAKD,WAAZ;;;;EAZ+Cb;;ACF5C,SAASgB,qBAAT,CAA+BR,KAA/B,EAAsC;MACvCS,MAAMT,KAAN,CAAJ,EAAkB,MAAM,IAAIU,KAAJ,CAAU,2BAAV,CAAN;MACdV,QAAQ,CAAZ,EAAe,MAAM,IAAIU,KAAJ,CAAU,oCAAV,CAAN;MACXC,KAAKC,KAAL,CAAWZ,KAAX,MAAsBA,KAA1B,EAAiC,MAAM,IAAIU,KAAJ,CAAU,iCAAV,CAAN;;;ICAdG;;;wBACPnB,IAAZ,EAAkBoB,UAAlB,EAA8BrB,OAA9B,EAAuCE,SAAvC,EAAkD;;;2HAC1CF,OAD0C,EACjCC,IADiC,EAC3BC,SAD2B;;UAE3CoB,WAAL,GAAmBD,cAAc,CAAjC;;;;;;4BAYME,OAAO;WACRvB,OAAL,CAAawB,GAAb,CAAiB,6BAAjB,EAAgDD,KAAhD;;;;oCAGc;WACTE,OAAL,CAAa,GAAb;;;;iCAGW;aACJ,KAAKxB,IAAZ;;;;6BAGO;UACHoB,aAAc,KAAKA,UAAvB;UACIpB,OAAc,KAAKyB,UAAL,EAAlB;UACIC,UAAc,IAAlB;UACIvD,OAAOwD,QAAP,CAAgB3B,IAAhB,CAAJ,EAA2B;kBACfA,KAAK4B,QAAL,CAAc,QAAd,CAAV;aACK7B,OAAL,CAAawB,GAAb,CAAiB,cAAjB,EAAiC,0BAAjC;OAFF,MAIK,IAAI7C,cAAcsB,IAAlB,EAAwB;kBACjB6B,KAAKC,SAAL,CAAe9B,IAAf,CAAV;aACKD,OAAL,CAAawB,GAAb,CAAiB,cAAjB,EAAiC,kBAAjC;OAFG,MAIA;;;aAGE;8BAAA;iBAES,KAAKxB,OAAL,CAAac,MAAb,EAFT;cAGSa;OAHhB;;;;2BApCe;aACR,KAAKL,WAAZ;;yBAGaf,OAAO;4BACEA,KAAtB;WACKe,WAAL,GAAmBf,KAAnB;;;;EAZsCR;;ICDrBiC;;;yBACPC,OAAZ,EAAqBC,IAArB,EAA2Bb,UAA3B,EAAuCrB,OAAvC,EAAgDE,SAAhD,EAA2D;;;6HACnDvB,SADmD,EACxC0C,UADwC,EAC5BrB,OAD4B,EACnBE,SADmB;;UAEpDgC,IAAL,GAAkBA,QAAQF,cAAcG,OAAxC;UACKF,OAAL,GAAkBA,WAAW,IAA7B;UACKG,IAAL,GAAkB,IAAlB;UACKC,OAAL,GAAkB,IAAlB;;;;;;iCAGW;aACJ;eACE;gBACK,KAAKH,IADV;mBAEK,KAAKD,OAFV;gBAGK,KAAKG,IAHV;mBAIK,KAAKC;;OALnB;;;;EAVuCjB;;AAqB3CY,cAAcG,OAAd,GAAiC,eAAjC;AACAH,cAAcM,OAAd,GAAiC,eAAjC;AACAN,cAAcO,GAAd,GAAiC,WAAjC;AACAP,cAAcQ,IAAd,GAAiC,sBAAjC;AACAR,cAAcS,eAAd,GAAiC,uBAAjC;;ICzBqBC;;;2BACPzC,IAAZ,EAAkBoB,UAAlB,EAA8BrB,OAA9B,EAAuCE,SAAvC,EAAkD;;4HAC1CD,IAD0C,EACpCoB,UADoC,EACxBrB,OADwB,EACfE,SADe;;;;;iCAIrC;aACJ,KAAKD,IAAZ;;;;EANyCmB;;ACAtC,SAASuB,iBAAT,CAA2BC,KAA3B,EAAkC1C,SAAlC,EAA6C;MAC9C2C,iBAAkBD,MAAMC,cAA5B;MACI7C,UAAkB4C,MAAM5C,OAAN,IAAiB,EAAvC;MACIC,OAAkB2C,MAAM3C,IAAN,IAAc,IAApC;MACIU,OAAkB,CAAC,CAACiC,MAAME,cAAN,IAAwB,EAAzB,EAA6BC,KAA7B,IAAsC,EAAvC,EAA2CC,KAA3C,CAAiD,GAAjD,CAAtB;MACIX,UAAU,IAAI7B,qBAAJ,CAA0B;oBAAA;eAExBN,aAAa2C,eAAe3C,SAFJ;YAGxB0C,MAAMK,UAAN,IAAoB,IAHI;UAIxBtC,IAJwB;cAKxBA,KAAKuC,KAAL,EALwB;iBAMxBN,MAAMO,qBANkB;aAOxBN;GAPF,CAAd;MASID,MAAMQ,eAAV,EAA2B;YACjBnD,IAAR,GAAe,IAAI7B,MAAJ,CAAW6B,IAAX,EAAiB,QAAjB,EAA2B4B,QAA3B,EAAf;GADF,MAGK,IAAI,OAAO5B,IAAP,KAAgB,QAApB,EAA8B;YACzBA,IAAR,GAAe6B,KAAKuB,KAAL,CAAWpD,IAAX,CAAf;;SAEKoC,OAAP;;;;;;;;;"}